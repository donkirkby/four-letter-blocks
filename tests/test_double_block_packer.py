from textwrap import dedent

import pytest

from four_letter_blocks.double_block_packer import DoubleBlockPacker


def test_different_space_count():
    front_text = dedent("""\
        #?????#
        ???#???
        ???????
        ?#?#?#?
        ???????
        ???#???
        #?????#""")
    back_text = dedent("""\
        #?????#
        ???#???
        ??????#
        ##?#?##
        #??????
        ???#???
        #?????#""")
    with pytest.raises(ValueError, match=r'Different space counts: 40 and 36\.'):
        DoubleBlockPacker(front_text, back_text, tries=100)


def test_fill():
    front_text = dedent("""\
        #?????#
        ???#???
        ???????
        ?#?#?#?
        ???????
        ???#???
        #?????#""")
    back_text = dedent("""\
        ??????#
        ?#?#???
        ???????
        ?#?#?#?
        ???????
        ???#?#?
        #??????""")
    packer = DoubleBlockPacker(front_text, back_text, tries=400)
    packer.fill()

    assert packer.is_full
    # packer.sort_blocks()
    # print(packer.display())
    # print(f'{packer.tries} tries left.')
    # assert False
